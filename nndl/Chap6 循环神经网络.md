# 循环神经网络

​	循环神经网络是一类具有短期记忆能 力的神经网络（前馈网络是一个静态网络，不具备这种记忆能力）。循环神经网络已经被广泛应用在语音识别、语言模型以及自然语言生成等任务上。

​	循环神经网络的参数学习可以通过随时间反向传播算法来学习，即按照时间的逆 序将错误信息一步步地往前传递。当输入序列比较长时，会存在梯度爆炸和消失 问题最有效的改进 方式引入门控机制。
​	循环神经网络可以很容易地扩展到两种更广义的记忆网络模型：递归神经网络和图网络。

## 一、简单神经网络

​	简单循环网络是只有一个隐藏层的神经网络。**在一个两层的前馈神经网络中，连接存在相邻的层与层之间，隐藏层的节点之间是无连接的。而简单循环网络增加了从隐藏层到隐藏层的反馈连接。**

​	近似定理：如果一个完全连接的循环神经网络有足够数量的sigmoid型隐藏神经元，它可以以任意的准确率去近似任何一个非线性动力系统 （系统状态按照一定的规律随时间变化的系统）

​	图灵完备：一个完全连接的循环神经网络可以近似解决所有的可计算问题。

## 二、应用到机器学习

### 1.序列到类别模式

​	主要用于序列数据的分类问题：输入为序列，输出为类别。 比如在文本分类中，输入数据为单词的序列，输出为该文本的类别。 

​	得到序列的最终表示，并输入给分类器进行分类。

![1572403154252](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1572403154252.png)

### 2.同步的序列到序列模式

​	主要用于序列标注任务，即每一时刻都有输入和输出，输入序列和输出序列的长度相同。比如词性标注中，每一个单词都需要标注其对应的词性标签。

![1572403169987](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1572403169987.png)

### 3.异步的序列到序列模式。

​	也称为编码器-解码器（Encoder-Decoder）模型，

​	输入序列和输出序列不需要有严格的对应关系，也不需要保持相同的长度。比如在机器翻译中，输入为源语言的单词序列，输出为目标语言的单词序列。

![1572404120984](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1572404120984.png)

## 三、两种计算梯度的方式

### 1.随时间反向传播

### 2.实时循环学习

## 四、长程依赖问题

指梯度消失或爆炸问题

为了解决这两个问题，可以通过引入**门控机制**来进一步改进模型。 

### 1.长短期记忆网络

### 2.门控循环单元网络 

## 五、深度RNN

num_layers参数的含义

![1573550281772](C:\Users\18742\AppData\Roaming\Typora\typora-user-images\1573550281772.png)

## 六、双向RNN

​	当我们写下一个句子时，可能会根据句子后面的词来修改句子前面的用词。双向循环神经网络通过增加从后往前传递信息的隐藏层来更灵活地处理这类信息。

![1573557293778](C:\Users\18742\AppData\Roaming\Typora\typora-user-images\1573557293778.png)